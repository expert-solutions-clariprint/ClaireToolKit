<html>
	<head>
		<title>
			Sax documentation
		</title>
		<style>
body
{
        font-size: 12px;
        font-family: arial, Helvetica;
        text-transform: inherit;
}


h1 { font-size: 25px; }

h2 { font-size: 20px; }

a[href]
{
	border-bottom: 1px dotted grey;
	text-decoration: none
}

.doc_paragraph
{
        font-size: 12px;
        font-family: arial, helvetica;
}

.item_header { font-size: 10px; page-break-before: avoid; page-break-inside: avoid; page-break-after: avoid }

.doc_code
{
        text-transform: inherit;
        font-size: 11px;
        font-family: monaco, courier, mono-space;
}
		</style>
		<link rel="stylesheet" type="text/css" href="doc.css" media="all">
	</head>
	<body>
	<h1>Sax v1.0.0  documentation</h1><p><i>Documentation generated by XL CLAIRE v3.3.37 at Fri, 17 Nov 2006</i></p><ul>
				<li><b>Author :</b> Sylvain BENILAN</li>
						</ul>
				<h1><a name='__category_index__'>Category index</a></h1>
		<ol><li><a href='#1082351345'>SAX parsing</a>
</li>
			</ol>
		<h1><a name='__method_index__'>Method index</a></h1>
		<ul><li><font font-face='Courier' class='doc_code'><a href='#1082354609'>sax</a>
(<font color='green'>self</font><font color='blue'>:</font>port, <font color='green'>xml_begin_element</font><font color='blue'>:</font>property, <font color='green'>xml_end_element</font><font color='blue'>:</font>property)<font color='blue'> =&gt; </font>any
	</font></li>
			<li><font font-face='Courier' class='doc_code'><a href='#1082412177'>sax</a>
(<font color='green'>p</font><font color='blue'>:</font>port, <font color='green'>xml_begin_element</font><font color='blue'>:</font>property, <font color='green'>xml_end_element</font><font color='blue'>:</font>property, <font color='green'>data</font><font color='blue'>:</font>any)<font color='blue'> -&gt; </font>any
	</font></li>
			<li><font font-face='Courier' class='doc_code'><a href='#1082351697'>set_handler</a>
(<font color='green'>xml_begin_element</font><font color='blue'>:</font>property, <font color='green'>xml_end_element</font><font color='blue'>:</font>property)<font color='blue'> -&gt; </font>void
	</font></li>
			</ul>
		<hr style='page-break-before: always; page-break-after: avoid' />
			<h1>Sax categories</h1>
		<a name='1082351345'><hr style='page-break-before: always' /></a>
		<table width='100%' class='item_header'>
		<tr>
			<td width='33%' align='left' valign='bottom'><i></i></td>
			<td width='33%' align='center' valign='top'><i><a href='#__category_index__'>categories</a><br/>SAX parsing
				</i></td>
			<td width='33%' align='right' valign='bottom'><i></i></td>
		</tr>
	</table>
	<h2>SAX parsing</h2>
	<ul><li><font font-face='Courier' class='doc_code'><a href='#1082354609'>sax</a>
(<font color='green'>self</font><font color='blue'>:</font>port, <font color='green'>xml_begin_element</font><font color='blue'>:</font>property, <font color='green'>xml_end_element</font><font color='blue'>:</font>property)<font color='blue'> =&gt; </font>any
	</font></li><li><font font-face='Courier' class='doc_code'><a href='#1082412177'>sax</a>
(<font color='green'>p</font><font color='blue'>:</font>port, <font color='green'>xml_begin_element</font><font color='blue'>:</font>property, <font color='green'>xml_end_element</font><font color='blue'>:</font>property, <font color='green'>data</font><font color='blue'>:</font>any)<font color='blue'> -&gt; </font>any
	</font></li><li><font font-face='Courier' class='doc_code'><a href='#1082351697'>set_handler</a>
(<font color='green'>xml_begin_element</font><font color='blue'>:</font>property, <font color='green'>xml_end_element</font><font color='blue'>:</font>property)<font color='blue'> -&gt; </font>void
	</font></li></ul><p align='justify' class='doc_paragraph'> <a href='#1082412177'><font color='#'>Sax</font></a> is a simple efficient <a href='#1082412177'><font color='#'>SAX</font></a> parser (Simple API for XML). It is used
 to parse simple XML stream in an event oriented way. It is fully written
 in CLAIRE (it has no dependency on a third party library).</p><p align='justify' class='doc_paragraph'> Here is a sample that shows how to use the parser. Let us consider the
 following XML that is inserted in a blob :
 <font size='2' face='Courier'>
										<table align=center width='85%' class='doc_code'>
										<tr><td font-face='Courier'><br/>&nbsp;<font color='black'>b</font>&nbsp;<font color=blue>:</font><font color=blue>:</font>&nbsp;<font color='#666633'>blob!</font>(<font color='#993333'>"<br>

     &lt;company name=&#39;XL&#39;&gt;<br>

         &lt;employee name=&#39;Sylvain&#39;&gt;<br>

             &lt;email&gt;s.benilan@claire-language.com&lt;/email&gt;<br>

         &lt;/employee&gt;<br>

     &lt;/company&gt;<br>

     "</font>)<br/>&nbsp;<br/></td></tr></table></font> We associate to this simple XML a simple CLAIRE class model :
 <font size='2' face='Courier'>
										<table align=center width='85%' class='doc_code'>
										<tr><td font-face='Courier'><br/>&nbsp;<font color='black'>employee</font>&nbsp;<font color='#0000CC'>&lt;:</font>&nbsp;<font color='#339966'>object</font>&nbsp;&nbsp;<font color='#FF9900'>// predef</font><br/><br/>&nbsp;<font color='black'>company</font>&nbsp;<font color='#0000CC'>&lt;:</font>&nbsp;<font color='#339966'>object</font>(<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color='#666633'>name</font><font color=blue>:</font><font color='#339966'>string</font>,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color='black'>employees</font><font color=blue>:</font><font color='#339966'>list</font>[<font color='black'>employee</font>])<br/><br/>&nbsp;<font color='black'>employee</font>&nbsp;<font color='#0000CC'>&lt;:</font>&nbsp;<font color='#339966'>object</font>(<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color='#666633'>name</font><font color=blue>:</font><font color='#339966'>string</font>,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color='black'>email</font><font color=blue>:</font><font color='#339966'>string</font>)<br/>&nbsp;<br/></td></tr></table></font> We now have to define an event responder for the company element. Notice that,
 in CLAIRE, we may define a really precise domain for our event responder
 (the dynamic dispatch engine of CLAIRE is smart enought to find the
 appropriate restriction). So we can define a restriction of
 xml_enter that takes precisely an element with name "company" :
 <font size='2' face='Courier'>
										<table align=center width='85%' class='doc_code'>
										<tr><td font-face='Courier'><br/>&nbsp;<font color='black'>xml_enter</font>(<font color='black'>data</font><font color=blue>:</font><font color='#339966'>list</font>[<font color='black'>company</font>],&nbsp;<font color='black'>elem</font><font color=blue>:</font>{<font color='#993333'>"company"</font>},&nbsp;<font color='black'>attrs</font><font color=blue>:</font><font color='#339966'>table</font>)&nbsp;<font color=blue>:</font>&nbsp;<font color='black'>company</font>&nbsp;<font color='#0000CC'>-&gt;</font><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color='#0000CC'>let</font></b>&nbsp;<font color='black'>c</font>&nbsp;<font color=blue>:</font><font color='#666633'>=</font>&nbsp;<font color='black'>company</font>(<font color='#666633'>name</font>&nbsp;<font color='#666633'>=</font>&nbsp;<font color='black'>attrs</font>[<font color='#993333'>"name"</font>])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color='#0000CC'>in</font></b>&nbsp;(<font color='black'>data</font>&nbsp;<font color='#666633'>add</font>&nbsp;<font color='black'>c</font>,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color='black'>c</font>)<br/>&nbsp;<font color='black'>xml_leave</font>(<font color='black'>data</font><font color=blue>:</font><font color='#339966'>list</font>[<font color='black'>company</font>],&nbsp;<font color='black'>elem</font><font color=blue>:</font>{<font color='#993333'>"company"</font>},&nbsp;<font color='black'>cdata</font><font color=blue>:</font><font color='#339966'>string</font>)&nbsp;<font color=blue>:</font>&nbsp;<font color='black'>employee</font>&nbsp;<font color='#0000CC'>-&gt;</font><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color='#0000CC'>none</font></b><br/>&nbsp;<br/></td></tr></table></font> Note that we return a new instance of company, this instance will be used
 as the data transmited to company's sub elements (i.e. emloyees). Then we
 need a responder for the employee element :
 <font size='2' face='Courier'>
										<table align=center width='85%' class='doc_code'>
										<tr><td font-face='Courier'><br/>&nbsp;<font color='black'>xml_enter</font>(<font color='black'>data</font><font color=blue>:</font><font color='black'>company</font>,&nbsp;<font color='black'>elem</font><font color=blue>:</font>{<font color='#993333'>"employee"</font>},&nbsp;<font color='black'>attrs</font><font color=blue>:</font><font color='#339966'>table</font>)&nbsp;<font color=blue>:</font>&nbsp;<font color='black'>employee</font>&nbsp;<font color='#0000CC'>-&gt;</font><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color='#0000CC'>let</font></b>&nbsp;<font color='black'>e</font>&nbsp;<font color=blue>:</font><font color='#666633'>=</font>&nbsp;<font color='black'>employee</font>(<font color='#666633'>name</font>&nbsp;<font color='#666633'>=</font>&nbsp;<font color='black'>attrs</font>[<font color='#993333'>"name"</font>])<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color='#0000CC'>in</font></b>&nbsp;(<font color='black'>data</font><font color=blue>.</font><font color='black'>employee</font>&nbsp;<font color='#666633'>add</font>&nbsp;<font color='black'>e</font>,<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color='black'>e</font>)<br/>&nbsp;<font color='black'>xml_leave</font>(<font color='black'>data</font><font color=blue>:</font><font color='black'>company</font>,&nbsp;<font color='black'>elem</font><font color=blue>:</font>{<font color='#993333'>"employee"</font>},&nbsp;<font color='black'>cdata</font><font color=blue>:</font><font color='#339966'>string</font>)&nbsp;<font color=blue>:</font>&nbsp;<font color='black'>employee</font>&nbsp;<font color='#0000CC'>-&gt;</font><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color='#0000CC'>none</font></b><br/>&nbsp;<br/></td></tr></table></font> Here, the domain of our responder is more precise again since we only want
 a data that is of range company. Then we need a responder for the email property
 of an employee, we'll define here a responder for an element 'leave' event :
 <font size='2' face='Courier'>
										<table align=center width='85%' class='doc_code'>
										<tr><td font-face='Courier'><br/>&nbsp;<font color='black'>xml_enter</font>(<font color='black'>data</font><font color=blue>:</font><font color='black'>employee</font>,&nbsp;<font color='black'>elem</font><font color=blue>:</font>{<font color='#993333'>"email"</font>},&nbsp;<font color='black'>attrs</font><font color=blue>:</font><font color='#339966'>table</font>)&nbsp;<font color=blue>:</font>&nbsp;<font color='#339966'>void</font>&nbsp;<font color='#0000CC'>-&gt;</font><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b><font color='#0000CC'>none</font></b><br/>&nbsp;<font color='black'>xml_leave</font>(<font color='black'>data</font><font color=blue>:</font><font color='black'>employee</font>,&nbsp;<font color='black'>elem</font><font color=blue>:</font>{<font color='#993333'>"email"</font>},&nbsp;<font color='black'>cdata</font><font color=blue>:</font><font color='#339966'>string</font>)&nbsp;<font color=blue>:</font>&nbsp;<font color='#339966'>void</font>&nbsp;<font color='#0000CC'>-&gt;</font><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<font color='black'>data</font><font color=blue>.</font><font color='black'>email</font>&nbsp;<font color=blue>:</font><font color='#666633'>=</font>&nbsp;<font color='black'>cdata</font>)<br/>&nbsp;<br/></td></tr></table></font> Now that our model is defined, we may invoke the <a href='#1082412177'><font color='#'>SAX</font></a> parser which is achieved with :
 <font size='2' face='Courier'>
										<table align=center width='85%' class='doc_code'>
										<tr><td font-face='Courier'><br/>&nbsp;<b><font color='#0000CC'>let</font></b>&nbsp;<font color='black'>companies</font>&nbsp;<font color=blue>:</font><font color='#666633'>=</font>&nbsp;<font color='#339966'>list</font>[<font color='black'>company</font>]<br/>&nbsp;<b><font color='#0000CC'>in</font></b>&nbsp;(<a href='#1082412177'><font color='#'>Sax</font></a>/<a href='#1082412177'><font color='#666633'>sax</font></a>(<font color='black'>b</font>,&nbsp;<font color='black'>xml_enter</font>,&nbsp;<font color='black'>xml_leave</font>,&nbsp;<font color='black'>companies</font>),<br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color=blue>.</font><font color=blue>.</font><font color=blue>.</font>&nbsp;<font color='#FF9900'>// something that uses companies</font><br/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)<br/>&nbsp;<br/></td></tr></table></font></p><hr style='page-break-before: always; page-break-after: avoid' />
			<h1>Sax methods</h1>
		<a name='1082354609'><hr style='page-break-after: avoid' /></a>
	<table width='100%' class='item_header'>
		<tr>
			<td width='20%' align='left'><i><a href='#__category_index__'>categories</a></i></td>
			<td width='20%' align='center'><i><a href='#1082351345'>SAX parsing</a>
</i></td><td width='20%' align='center'><i>inline</i></td>
	<td width='20%' align='center'><i></i></td><td width='20%' align='right'><i>Sax method</i></td>
	</tr></table><h3>Sax/sax(<font color='green'>self</font><font color='blue'>:</font>port, <font color='green'>xml_begin_element</font><font color='blue'>:</font>property, <font color='green'>xml_end_element</font><font color='blue'>:</font>property)<font color='blue'> =&gt; </font>any
	</h3><p align='justify' class='doc_paragraph'> sax(p,<b>xml_begin_element</b>, <b>xml_end_element</b>) is equivalent to
 sax(p,<b>xml_begin_element</b>, <b>xml_end_element</b>, unknown).</p><a name='1082412177'><hr style='page-break-after: avoid' /></a>
	<table width='100%' class='item_header'>
		<tr>
			<td width='20%' align='left'><i><a href='#__category_index__'>categories</a></i></td>
			<td width='20%' align='center'><i><a href='#1082351345'>SAX parsing</a>
</i></td><td width='20%' align='center'><i>normal dispatch</i></td>
	<td width='20%' align='center'><i></i></td><td width='20%' align='right'><i>Sax method</i></td>
	</tr></table><h3>Sax/sax(<font color='green'>p</font><font color='blue'>:</font>port, <font color='green'>xml_begin_element</font><font color='blue'>:</font>property, <font color='green'>xml_end_element</font><font color='blue'>:</font>property, <font color='green'>data</font><font color='blue'>:</font>any)<font color='blue'> -&gt; </font>any
	</h3><p align='justify' class='doc_paragraph'> sax(<b>p</b>, <b>xml_begin_element</b>, <b>xml_end_element</b>, <b>data</b>) read on the port <b>p</b> an XML stream
 in an event oriented way. Each time an element is entered (resp. leaved) the property
 <b>xml_begin_element</b> (resp. <b>xml_end_element</b>) is applied. The user code should define the
 appropriate restrictions of given properties as a receiver of generated events. The
 given <b>data</b> will be sent to event receivers and the returned value of an enter receiver
 will be used as the <b>data</b> sent to receivers of child elements.
 The event receiver should be defined with the following prototype :
 <font size='2' face='Courier'>
										<table align=center width='85%' class='doc_code'>
										<tr><td font-face='Courier'><br/>&nbsp;<font color='black'>xml_begin_element</font>(<font color='black'>data</font><font color=blue>:</font><font color='#339966'>any</font>,&nbsp;<font color='black'>element_name</font><font color=blue>:</font><font color='#339966'>string</font>,&nbsp;<font color='black'>attributes</font><font color=blue>:</font><font color='#339966'>table</font>)&nbsp;<font color='#0000CC'>-&gt;</font>&nbsp;<font color='#339966'>any</font><br/>&nbsp;<font color='black'>xml_end_element</font>(<font color='black'>data</font><font color=blue>:</font><font color='#339966'>any</font>,&nbsp;<font color='black'>element_name</font><font color=blue>:</font><font color='#339966'>string</font>,&nbsp;<font color='black'>cdata</font><font color=blue>:</font><font color='#339966'>string</font>)&nbsp;<font color='#0000CC'>-&gt;</font>&nbsp;<font color='#339966'>void</font><br/>&nbsp;<br/></td></tr></table></font> Where attributes is a table containing the attributes of an XML element which associates
 an attribute name to its value, both of range string. cdata is a string that contain
 the string <b>data</b> of an XML element.</p><p align='justify' class='doc_paragraph'> If <b>data</b> is unknown then the prototype of receivers is simplified in :
 <font size='2' face='Courier'>
										<table align=center width='85%' class='doc_code'>
										<tr><td font-face='Courier'><br/>&nbsp;<font color='black'>xml_begin_element</font>(<font color='black'>element_name</font><font color=blue>:</font><font color='#339966'>string</font>,&nbsp;<font color='black'>attributes</font><font color=blue>:</font><font color='#339966'>table</font>)&nbsp;<font color='#0000CC'>-&gt;</font>&nbsp;<font color='#339966'>void</font><br/>&nbsp;<font color='black'>xml_end_element</font>(<font color='black'>element_name</font><font color=blue>:</font><font color='#339966'>string</font>,&nbsp;<font color='black'>cdata</font><font color=blue>:</font><font color='#339966'>string</font>)&nbsp;<font color='#0000CC'>-&gt;</font>&nbsp;<font color='#339966'>void</font><br/>&nbsp;<br/></td></tr></table></font></p><a name='1082351697'><hr style='page-break-after: avoid' /></a>
	<table width='100%' class='item_header'>
		<tr>
			<td width='20%' align='left'><i><a href='#__category_index__'>categories</a></i></td>
			<td width='20%' align='center'><i><a href='#1082351345'>SAX parsing</a>
</i></td><td width='20%' align='center'><i>normal dispatch</i></td>
	<td width='20%' align='center'><i></i></td><td width='20%' align='right'><i>Sax method</i></td>
	</tr></table><h3>Sax/set_handler(<font color='green'>xml_begin_element</font><font color='blue'>:</font>property, <font color='green'>xml_end_element</font><font color='blue'>:</font>property)<font color='blue'> -&gt; </font>void
	</h3><p align='justify' class='doc_paragraph'> set_handlers(<b>xml_begin_element</b>, <b>xml_end_element</b>) allows to change the selector
 of the event receivers from within an event receiver.</p></body>
	</html>